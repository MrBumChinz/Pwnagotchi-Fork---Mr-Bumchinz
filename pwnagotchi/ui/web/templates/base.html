<!DOCTYPE html>
<html lang="en">
{% block head %}
<head>
    {% block meta %}
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0a0a0f">
    <meta name="description" content="Pwnagotchi Web Interface">
    {% endblock %}

    <title>
        {% block title %}
        Pwnagotchi
        {% endblock %}
    </title>

    {% block styles %}
    <link rel="stylesheet" href="/js/jquery.mobile/jquery.mobile-1.4.5.min.css"/>
    <link rel="stylesheet" type="text/css" href="/css/style.css"/>
    <link rel="stylesheet" type="text/css" href="/css/modern.css"/>
    <link rel="apple-touch-icon" href="/images/pwnagotchi.png">
    <link rel="icon" type="image/png" href="/images/pwnagotchi.png">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        code, pre, .mono { font-family: 'Fira Code', 'Consolas', monospace; }
    </style>
    {% endblock %}

</head>
{% endblock %}

{% block body %}
<body>
<div data-role="page" data-theme="a">

    {% if error %}
    <div id="error" class="error notification" data-role="popup" data-overlay-theme="a">
        <div class="notification-content">
            <span class="notification-icon">‚ö†Ô∏è</span>
            <p>{{ error }}</p>
            <button onclick="$('#error').popup('close');" class="notification-close">√ó</button>
        </div>
    </div>
    <script>
        $(function(){
            $("#error").popup("open");
            setTimeout(function() {
                $("#error").popup("close");
            }, 5000);
        });
    </script>
    {% endif %}

    {% set navigation = [
        ( '/', 'home', 'üëÅÔ∏è', 'Home' ),
        ( '/inbox', 'inbox', 'üì•', 'Inbox' ),
        ( '/inbox/new', 'new', '‚úâÔ∏è', 'New' ),
        ( '/inbox/profile', 'profile', 'üë§', 'Profile' ),
        ( '/inbox/peers', 'peers', 'ü§ù', 'Peers' ),
        ( '/plugins', 'plugins', 'üîå', 'Plugins' ),
    ] %}
    {% set active_page = active_page|default('home') %}

    <div data-role="footer" data-position="fixed" data-tap-toggle="false">
        <div data-role="navbar" data-iconpos="left">
            <ul>
                {% for href, id, icon, caption in navigation %}
                    <li class="navitem">
                       <a href="{{ href }}" id="{{ id }}" class="{{ 'ui-btn-active' if active_page == id }}">
                           <span class="nav-icon">{{ icon }}</span>
                           <span class="nav-text">{{ caption }}</span>
                       </a>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <div data-role="content" class="ui-content">
        {% block content %}
        {% endblock %}
    </div>

</div>
{% block scripts %}
<script type="text/javascript" src="/js/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="/js/jquery.mobile/jquery.mobile-1.4.5.min.js"></script>
<script type="text/javascript" src="/js/jquery.timeago.js"></script>
<script type="text/javascript" src="/js/kjua-0.9.0.min.js"></script>
<script type="text/javascript">
    $.mobile.ajaxEnabled = false;
    $.mobile.pushStateEnabled = false;

    jQuery(document).ready(function() {
        jQuery("time.timeago").timeago();
        
        // Add smooth transitions
        $('a').on('click', function() {
            if (!$(this).hasClass('ui-btn-active')) {
                $('body').css('opacity', '0.8');
            }
        });
    });

    {% block script %}
    {% endblock %}
</script>
{% endblock %}
</body>
{% endblock %}
</html>
