# Pwnagotchi Configuration Fixes for Nexmon Stability
# ===================================================
#
# Add these settings to your /etc/pwnagotchi/config.toml
# to improve stability with Nexmon-patched firmware.
#
# These settings help reduce the frequency of the "blindness bug"
# and firmware crashes by reducing the load on the WiFi chip.

# ===================
# MAIN CONFIGURATION
# ===================

# Reduce AI activity to lower WiFi load
main.ai.throttle = 0.2

# ===================
# BETTERCAP SETTINGS
# ===================

# Increase minimum channel hop time (default is often too fast)
# Higher values = less channel hopping = fewer crashes
# Recommended: 250-500 for stability
bettercap.wifi.hop.recon_time = 300

# Increase time on each channel before hopping
# This gives the firmware time to stabilize
bettercap.wifi.hop.period = 3

# Limit to 2.4GHz channels only (reduces channel switching)
# 5GHz channels are more prone to causing issues
# Uncomment the next line to limit to 2.4GHz only
# bettercap.wifi.hop.channels = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]

# Reduce the number of deauth frames sent
# This significantly reduces the crash frequency
bettercap.deauth.frames = 1
bettercap.deauth.skip = 30

# ===================
# WATCHDOG SETTINGS
# ===================

# Enable the built-in watchdog plugin
main.plugins.watchdog.enabled = true
main.plugins.watchdog.delay = 30

# If using our enhanced watchdog plugin instead:
main.plugins.nexmon_watchdog.enabled = true
main.plugins.nexmon_watchdog.blind_epochs = 10
main.plugins.nexmon_watchdog.crash_recovery = true
main.plugins.nexmon_watchdog.soft_recovery_first = true
main.plugins.nexmon_watchdog.max_recovery_attempts = 3
main.plugins.nexmon_watchdog.reboot_on_failure = true

# ===================
# PERSONALITY TUNING
# ===================

# Make the AI less aggressive to reduce WiFi load
personality.bond_encounters_factor = 1000
personality.associate = false
personality.deauth = true
personality.channels = []
personality.min_rssi = -200
personality.ap_ttl = 120
personality.sta_ttl = 300
personality.recon_time = 30
personality.min_recon_time = 5
personality.max_inactive_scale = 2
personality.recon_inactive_multiplier = 2
personality.hop_recon_time = 10
personality.sad_num_epochs = 25
personality.bored_num_epochs = 50
personality.excited_num_epochs = 5

# ===================
# EXPERIMENTAL
# ===================

# Disable features that cause heavy WiFi activity
# main.plugins.assoc.enabled = false  # Uncomment if crashes are frequent
